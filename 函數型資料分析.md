函數型資料分析

複習網址:
⦁	https://functionaldataanalysis.org/index.html
⦁	https://builtin.com/data-science/step-step-explanation-principal-component-analysis


甚麼是函數型資料
⦁	將蒐集的資料作成曲線
⦁	函數為多變量資料(multivariate data) with an ordering on the dimensions
⦁	假設為平滑的(yᵢⱼ=xᵢ(tᵢⱼ)+εᵢⱼ)

%蒐集完資料後，繪製成平滑的曲線，取平均曲線，發現這些曲線可以表示平均，但不夠完美(i.e.不夠代表資料的平均，especially 資料龐大，跳躍的幅度大太)


模型
⦁	將 r.v. X is called functional variable if it takes values on an infinite dimensional space(or functional space)
      𝑋 ={𝑋 𝑡 ,𝑡 ∈ 𝑇}
⦁	函數型的資料型為 X₁ ,..., Xₙ
⦁	Longitudinal data {(tᵢⱼ,yᵢⱼ), 1<= j <=mᵢ , 1<= i <= n}
⦁	regular or irreguar(所有資料時間不同)、 desnsely(如地震波(每秒震動約500次)，時間間隔短，資料很密集)、 sparsely(觀測次數少、時間少，如病人回診，可能一年回診兩次，不可能肯定說病人這一年的健康程度)


分析的目標
⦁	如何大筆資料中將趨勢線表示出來
⦁	如何找出大筆資料中的特徵
⦁	變因與結果有無很重要的現象(之間的關聯)
⦁	比較兩筆或多筆的data


FDA的步驟
⦁	Data代表，找出資料的平滑與內插
⦁	Data的定位(registration)與對齊(alignment)>>有時候同種實驗中，圖型很像，但很常有左右平移的現象，畫平均的線會有問題，因此需要重新定位與對齊
⦁	如何畫出資料的圖型(Data display)


Exploring Varinability in FD
⦁	Interests
        1.呈現的分布圖與函數(找Mean、variance、covariance)
        2.關聯性(Covariate reaponses)、函數的導數

⦁	What are the challenges?
        1. Estimation of functional data from noisy, discrete observations.
        2. Numerical representation of infinite-dimensional objects
        3. Representation of variation in infinite dimensions.
        4. Description of statistical relationships between infinite dimensional objects.
        5. 𝑛 < 𝑝 =∞,anduse of smoothness.
        6. Measures of variation in estimates.
        .......


Representing Functional Data
⦁	From discrete to functional data
   Represent data recorded at discrete times as a continuous function in order to
         Allow evaluation of record at any yᵢⱼ=xᵢ(tᵢⱼ)+εᵢⱼ) point.
         Evaluate rates of change.
         Reduce noise.
         Allow registration onto a common time-scale.
          yᵢ=x(tᵢ)+εᵢ) ,𝑖 = 1,…,𝑛.

%目前想要構成函數，因此需要找到基底，方法如下

⦁	Method 1: Representing functions by basis functions
 	*Basis-expansion methods
 		#傅立葉作為基底>>有週期性的資料
 				#The spline basis>>非週期性的資料
⦁	Method 2: Reducing noise in measurements
 	*Smoothing penalties (加入懲罰項，越不平滑，加入的懲罰項越大，使其更平滑)


呈現函數資料方法一 : Properties of B-splines
⦁	Number of basis functions
 	order + number interior knots e.g. 4 + 9 = 13
⦁	Order 𝑚 splines: derivatives up to (m – 2) are continuous.
⦁	Support on 𝑚 adjacent intervals =>  highly sparse design matrix.
⦁	Advice
 	1.Flexibility comes from knots; derivatives from order.
 	2.Frequently, fewer knots will do just as well (approximation properties can be formalized).

%好處是節點(knot)不用太多


呈現函數資料方法二 : Local polynomial smoothing
⦁	使用低次的多項式作基底
⦁	參數C的估計，與權重有關，離我有關的點，權重較高


EDA
⦁	在做資料的估計(EDA)前，會先做pre-smooth ，不過需要資料要夠多，不能是sparsely。
⦁	做完之後，可以判斷，Mean function、Variance function、Covariance and correlation functions
 		1.平均用樣本平均估計
 	2.變異數用樣本變異數估計
 	3.共變變異數用樣本共變異數估計，也可以估計相關係數
⦁	Cross-covariance and cross-correlation functions
𝐶𝑜𝑣𝑋𝑠 ,𝑌𝑡 =𝐸[(𝑋𝑠 −𝜇𝑋(𝑠))(𝑌𝑡 −𝜇𝑌(𝑡))]
 	𝐶𝑜𝑟𝑟𝑋𝑠 ,𝑌𝑡 = 𝐶𝑜𝑣(𝑋𝑠 ,𝑌(𝑡))／sqar( 𝑉𝑎𝑟𝑋𝑠 𝑉𝑎𝑟(𝑌(𝑡)))
⦁	Functional PCA (Principal components analysis，主成分分析)
 	1.探索典型函數的特徵
 	2.低維度總結/解釋
 	3.可以降維度
⦁	 






























 
